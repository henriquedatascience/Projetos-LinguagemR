df2 %>%
mutate(name = fct_reorder(CustoTotal, GrupoDiagnostico)) %>%
ggplot(aes(x=CustoTotal, y=GrupoDiagnostico)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x=CustoTotal, y=GrupoDiagnostico)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x=CustoTotal, y=GrupoDiagnostico)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x=CustoTotal, y=GrupoDiagnostico)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
?ggplot2
?geom_bar
ggplot(df2, aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
df2 %>%
mutate(name = fct_reorder(GrupoDiagnostico, CustoTotal)) %>%
ggplot(aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
df2 %>%
mutate(name = reorder(GrupoDiagnostico, CustoTotal)) %>%
ggplot(aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
df2 %>%
mutate(name = reorder(CustoTotal, GrupoDiagnostico)) %>%
ggplot(aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
View(df2)
ggplot(df2, aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar()
ggplot(df2, aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat = 'identity')
ggplot(df2, aes(x=CustoTotal, y=GrupoDiagnostico)) +
geom_bar(stat = 'identity')
df2 %>%
mutate(name = reorder(CustoTotal, GrupoDiagnostico)) %>%
ggplot(aes(x=CustoTotal, y=GrupoDiagnostico)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
df2$GrupoDiagnostico <- as.factor(df2$GrupoDiagnostico)
ggplot(df2, aes(x=GrupoDiagnostico, y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
?reorder
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
?options
options(scipen = 999)
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Distribuição de Idade dos Pacientes") +
theme_light() +
theme(
plot.title = element_text(size=20)
)
library(sqldf)
library(ggplot2)
library(hrbrthemes)
library(GGally)
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Distribuição de Idade dos Pacientes") +
theme_light() +
theme(
plot.title = element_text(size=20)
)
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
options(scipen = 999)
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
# A raça do paciente tem relação com o total gasto em internações no hospital?
df3 <- sqldf('SELECT Raça, SUM(CustoDaInternacao) as CustoTotal
FROM df
GROUP BY Raça
ORDER BY CustoTotal DESC')
df3$Raça <- as.factor(df3$Raça)
ggplot(df2, aes(x=Raça, y=CustoTotal, color=Raça)) +
geom_point(size=5) +
theme_ipsum()
View(df3)
df3$Raça <- as.factor(df3$Raça)
ggplot(df3, aes(x=Raça, y=CustoTotal, color=Raça)) +
geom_point(size=5) +
theme_ipsum()
cor(df$Raça, df$CustoDaInternacao)
warnings()
ggplot(df, aes(x=CustoDaInternacao, y=Idade, color=Genero)) +
geom_point(size=3) +
theme_ipsum()
df4 <- sqldf('SELECT Idade, Genero, SUM(CustoDaInternacao) as CustoTotal
FROM df
')
View(df4)
df4 <- sqldf('SELECT Idade, Genero, SUM(CustoDaInternacao) as CustoTotal
FROM df
GROUP BY Idade')
View(df4)
df4 <- sqldf('SELECT Idade, Genero, SUM(CustoDaInternacao) as CustoTotal
FROM df
GROUP BY Idade, Genero')
View(df4)
ggplot(df4, aes(x=CustoDaInternacao, y=Idade, color=Genero)) +
geom_point(size=3) +
theme_ipsum()
ggplot(df4, aes(x=CustoTotal, y=Idade, color=Genero)) +
geom_point(size=3) +
theme_ipsum()
ggplot(df4, aes(x=Idade, y=CustoTotal, color=Genero)) +
geom_point(size=3) +
theme_ipsum()
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Distribuição de Idade dos Pacientes") +
theme_light() +
theme(
plot.title = element_text(size=20)
)
library(sqldf)
library(ggplot2)
library(hrbrthemes)
library(GGally)
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Distribuição de Idade dos Pacientes") +
theme_light() +
theme(
plot.title = element_text(size=20)
)
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle('Distribuição de Idade dos Pacientes') +
xlab('1') +
ylab('2')
theme_light() +
theme(
plot.title = element_text(size=20)
)
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle('Distribuição de Idade dos Pacientes') +
xlab('1') +
ylab('2') +
theme_light() +
theme(
plot.title = element_text(size=20)
)
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle('Distribuição de Idade dos Pacientes') +
xlab('Idade') +
ylab('Número de Crianças') +
theme_light() +
theme(
plot.title = element_text(size=20)
)
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle('Distribuição de Idade dos Pacientes') +
xlab('Idade') +
ylab('Quantidade de Crianças') +
theme_light() +
theme(
plot.title = element_text(size=20)
)
?ggtitle
ggplot(df, aes(x = Idade)) +
geom_histogram(binwidth=3, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle('Distribuição de Idade dos Pacientes') +
xlab('Idade') +
ylab('Quantidade de Pacientes') +
theme_light() +
theme(plot.title = element_text(size=20, hjust = 0.5)
)
View(df)
View(df)
gasto_por_idade <- aggregate(CustoDaInternacao ~ Idade,
FUN = SUM,
data = df)
gasto_por_idade <- aggregate(CustoDaInternacao ~ Idade,
FUN = sum,
data = df)
View(gasto_por_idade)
options(scipen = 999)
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$CustoDaInternacao,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
ylim=c(0,40)
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
ylim=c(0,40)
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
ylim=c(0,70000)
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
ylim=c(0,100000)
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$CustoDaInternacao,
color='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$CustoDaInternacao,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col='#e9ecef',
xlab="categories",
ylab="values",
main="My title",
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col="#e9ecef",
xlab="categories",
ylab="values",
main="My title",
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col="#e9ecef",
xlab="Idade",
ylab="Total Gasto",
main="Iade Dos Pacientes Com Maior Gasto",
)
barplot(height=gasto_por_idade$CustoDaInternacao, names=gasto_por_idade$Idade,
col="#69b3a2",
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#69b3a2", alpha=.8, width=.9) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#69b3a2", width=.9) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(df2, aes(x= reorder(GrupoDiagnostico, -CustoTotal, decreasing = TRUE), y=CustoTotal)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
gasto_total_diag <- aggregate(CustoDaInternacao ~ GrupoDiagnostico,
FUN = sum,
data = df)
View(gasto_total_diag)
gasto_por_diag <- aggregate(CustoDaInternacao ~ GrupoDiagnostico,
FUN = sum,
data = df)
ggplot(gasto_por_diag, aes(x= reorder(GrupoDiagnostico, -CustoDaInternacao, decreasing = TRUE), y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
gasto_por_diag[which.max(gasto_por_diag), ]
gasto_por_diag[which.max(gasto_por_diag$GrupoDiagnostico), ]
gasto_por_diag[which.max(gasto_por_diag$CustoDaInternacao), ]
ggplot(gasto_por_diag, aes(x= reorder(GrupoDiagnostico, -CustoDaInternacao, decreasing = TRUE), y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(gasto_por_diag[, 1:10], aes(x= reorder(GrupoDiagnostico, -CustoDaInternacao, decreasing = TRUE), y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
library(dplyr)
ggplot(slice(gasto_por_diag, 1:10), aes(x= reorder(GrupoDiagnostico, -CustoDaInternacao, decreasing = TRUE), y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
?aggregate
gasto_por_diag <- arrange(gasto_por_diag, desc(CustoDaInternacao))
View(gasto_por_diag)
ggplot(slice(gasto_por_diag, 1:10), aes(x=GrupoDiagnostico, y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(slice(gasto_por_diag, 1:10), aes(x=GrupoDiagnostico, y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2") +
coord_flip() +
xlab("") +
theme_bw()
ggplot(slice(gasto_por_diag, 1:10), aes(x=CustoDaInternacao, y=GrupoDiagnostico)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(gasto_por_diag, aes(x=GrupoDiagnostico, y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
ggplot(gasto_por_diag, aes(x=GrupoDiagnostico, y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.1) +
coord_flip() +
xlab("") +
theme_bw()
barplot(height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1
xlab="Idade",
barplot(height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
barplot(height=slice(gasto_por_diag$CustoDaInternacao, 1:10), names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
?barplot
barplot(height=gasto_por_diag$CustoDaInternacao[1:10, ], names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
gasto_por_diag <- gasto_por_diag[order(gasto_por_diag$CustoDaInternacao, decreasing = TRUE), ]
View(gasto_por_diag)
ggplot(gasto_por_diag, aes(x=GrupoDiagnostico, y=CustoDaInternacao)) +
geom_bar(stat="identity", fill="#69b3a2", width=.8) +
coord_flip() +
xlab("") +
theme_bw()
barplot(slice(gasto_por_diag, 1:10), height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
barplot(data=gasto_por_diag, height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
gasto_por_diag <- gasto_por_diag[order(gasto_por_diag$CustoDaInternacao), ]
barplot(height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
gasto_por_diag <- slice(gasto_por_diag, 1:10)
View(gasto_por_diag)
gasto_por_diag[which.max(gasto_por_diag$CustoDaInternacao), ]
View(gasto_por_diag)
gasto_por_diag <- gasto_por_diag[order(gasto_por_diag$CustoDaInternacao, decreasing = TRUE), ]
gasto_por_diag <- slice(gasto_por_diag, 1:10)
View(gasto_por_diag)
gasto_por_diag <- aggregate(CustoDaInternacao ~ GrupoDiagnostico,
FUN = sum,
data = df)
gasto_por_diag <- gasto_por_diag[order(gasto_por_diag$CustoDaInternacao, decreasing = TRUE), ]
View(gasto_por_diag)
gasto_por_diag <- slice(gasto_por_diag, 1:10)
View(gasto_por_diag)
gasto_por_diag[which.max(gasto_por_diag$CustoDaInternacao), ]
barplot(height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
?barplot
gasto_por_diag <- gasto_por_diag[order(gasto_por_diag$CustoDaInternacao), ]
barplot(height=gasto_por_diag$CustoDaInternacao, names=gasto_por_diag$GrupoDiagnostico,
col="#69b3a2",
horiz = T, las = 1,
xlab="Idade",
ylab="Total Gasto",
main="Idade Dos Pacientes Com Maior Gasto",
)
gasto_por_diag[which.max(gasto_por_diag$CustoDaInternacao), ]
modelo_anova <- aov(CustoDaInternacao ~ Raça, data = df)
summary(modelo_anova)
modelo_anova1 <- aov(CustoDaInternacao ~ Raça, data = df)
modelo_anova2 <- aov(CustoDaInternacao ~ Idade + Genero, data = df)
summary(modelo_anova2)
summary(modelo_anova1)
modelo_lm1 <- ml(TempoDaInternacao ~ Idade + Genero + Raça, data = df)
modelo_lm1 <- lm(TempoDaInternacao ~ Idade + Genero + Raça, data = df)
summary(modelo_lm1)
modelo_v1 <- lm(TempoDaInternacao ~ ., data = df)
summary(modelo_v1)
modelo_v2 <- lm(TempoDaInternacao ~ Genero + CustoDaInternacao + GrupoDiagnostico, data = df)
summary(modelo_v2)
summary(modelo_v2)
modelo_v2 <- lm(TempoDaInternacao ~
Genero +
Idade +
CustoDaInternacao +
GrupoDiagnostico,
data = df)
summary(modelo_v2)
modelo_v2 <- lm(TempoDaInternacao ~
Idade +
CustoDaInternacao +
GrupoDiagnostico,
data = df)
summary(modelo_v2)
modelo_v1 <- lm(CustoDaInternacao ~ ., data = df)
summary(modelo_v1)
modelo_v2 <- lm(CustoDaInternacao ~
Idade +
TempoDaInternacao +
GrupoDiagnostico,
data = df)
summary(modelo_v2)
?aggregate
